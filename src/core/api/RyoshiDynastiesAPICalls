import axios from "axios";
// import {ListingsQuery} from "@src/core/api/queries/listings";

const api = axios.create({
  baseURL: 'api/',
});

const baseURL = 'https://testcms.ebisusbay.biz/';

//gets the current game id
export const getWeeklyGameId = async () => {
  try{
    var data = await api.get(baseURL + "api/ryoshi-dynasties/games/0");
    return data.data.data.id;
  }
  catch(error){
    throw error;
  }
}
export const getSeasonGameId = async () => {
  try{
    var data = await api.get(baseURL + "api/ryoshi-dynasties/games/0");
    return data.data.data.parent.id;
  }
  catch(error){
    throw error;
  }
}
//gets the map for the game
export const getMap = async (_gameNumber) => {
  try{
    return await api.get(baseURL + "api/ryoshi-dynasties/games/"+_gameNumber);
  }
  catch(error){
    throw error;
  }
}
export const getProfileTroops = async (_address, _signature) => {
  try{
    return await api.get(baseURL + "api/ryoshi-dynasties/armies?",
      {params: {address: _address, signature: _signature}});
  }
  catch(error){
    throw error;
  }
}
//gets a specific control point
export const getControlPoint = async (_controlPointId) => {
  try{
    return await api.get(baseURL + "api/ryoshi-dynasties/control-point?", 
      {params: {controlPointId: _controlPointId}});
  }
  catch(error){
    throw error;
  }
}
//creates a faction
export const createFaction = async (_walletAddress, _walletSignature) => {
  try{
    return await api.get(baseURL + "api/ryoshi-dynasties/factions?", 
      {params: {walletAddress: _walletAddress, walletSignature: _walletSignature}});
  }
  catch(error){
    throw error;
  }
}
//gets specific factions
export const getFactions = async ( _profileOwnerId) => {
  try{
    return await api.get(baseURL + "api/ryoshi-dynasties/factions?", 
      {params: {profileOwnerId: _profileOwnerId}});
  }
  catch(error){
    throw error;
  }
}
//registers a faction for the season
export const subscribeFaction = async (_walletAddress, _walletSignature, _gameId, _factionId) => {
  try{
    return await api.get(baseURL + "api/ryoshi-dynasties/subscriptions?", 
      {params: {walletAddress: _walletAddress, walletSignature: _walletSignature}},
      {body: {gameId: _gameId, factionId: _factionId}});
  }
  catch(error){
    throw error;
  }
}
//adds troops to the player's wallet
export const createArmy = async (_walletAddress, _walletSignature, _troops) => {
  try{
    return await api.get(baseURL + "api/ryoshi-dynasties/army?", 
      {params: {walletAddress: _walletAddress, walletSignature: _walletSignature}},
      {body: {troops: _troops}});
  }
  catch(error){
    throw error;
  }
}
//takes troops from a player's wallet and adds them to a faction
export const delegateTroops = async (address, signature, troops, factionId) => {
  try{
    var gameID = await api.get(baseURL + "api/ryoshi-dynasties/games/0");
    // console.log("GameID: "+gameID.data.data.id);
    let gameId = gameID.data.data.id;
    console.log("GameID: "+gameId);
    console.log("FactionID: "+factionId);
    console.log("Troops: "+troops);
    
    return await api.patch(baseURL + "api/ryoshi-dynasties/armies?", 
      {troops, factionId, gameId},
      {params: {address: address, signature: signature, action: "DELEGATE"}},
      );
  }
  catch(error){
    throw error;
  }
}
//deploys troops from a faction to a control point
export const deployTroops = async (_walletAddress, _walletSignature, _troops, _controlPointId, _gameId, _factionId) => {
  try{
    return await api.get(baseURL + "api/ryoshi-dynasties/army?", 
      {params: {walletAddress: _walletAddress, walletSignature: _walletSignature, action: "DEPLOY"}},
      {body: {troops: _troops, controlPointId: _controlPointId, gameId: _gameId, factionId: _factionId}});
  }
  catch(error){
    throw error;
  }
}
//recalls troops from a control point and returns them to the faction
export const recallTroops = async (_walletAddress, _walletSignature, _troops, _controlPointId, _gameId, _factionId) => {
  try{
    return await api.get(baseURL + "api/ryoshi-dynasties/army?", 
      {params: {walletAddress: _walletAddress, walletSignature: _walletSignature, action: "RECALL"}},
      {body: {troops: _troops, controlPointId: _controlPointId, gameId: _gameId, factionId: _factionId}});
  }
  catch(error){
    throw error;
  }
}
export const getReward= async (_rewardNumber) => {
  try{
    var data = await api.get(baseURL + "api/ryoshi-dynasties/rewards/"+_rewardNumber);
    return data.data.data;
  }
  catch(error){
    throw error;
  }
}
export const getProfileId = async (_address, _signature) => {
  try{
    var data = await api.get(baseURL + "api/ryoshi-dynasties/armies?",
      {params: {address: _address, signature: _signature}});
    return data;
  }
  catch(error){
    throw error;
  }
}
export const getAllFactions = async () => {
  try{
    var gameID = await api.get(baseURL + "api/ryoshi-dynasties/games/0");
    var data = await api.get(baseURL + "api/ryoshi-dynasties/control-points/1",
      {params: {gameId: gameID.data.data.id}});
    return data.data.data.leaderBoard;
  }
  catch(error){
    throw error;
  }
}
export const addTroops = async (address, signature, troops) => {
  try{
    return await api.post(baseURL + "api/ryoshi-dynasties/armies?", 
      {troops},
      {params: {address, signature}});
  }
  catch(error){
    throw error;
  }
}